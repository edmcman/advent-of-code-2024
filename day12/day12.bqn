in â† >â€¢file.Lines "input.txt"
#â€¢Show in

OnGrid â† âˆ§Â´(â‰¥âŸœ0)âˆ¾<âŸœ(â‰¢in)
GetIndices â† /â—‹â¥ŠâŸœ(â†•â‰¢)

dirs â† âŸ¨
    0â€¿1
    1â€¿0
    0â€¿Â¯1
    Â¯1â€¿0
âŸ©

Search â† {gridâ€¿type ğ•Š coordâ€¿visited:
    visited â†© (â·visitedâˆ¾(â‹ˆcoord))
    # wow so tacit!
    neighbors â† (Â¬âˆ˜âˆŠâŸœvisitedâŠ¸/) ((type=âŠ‘âŸœgrid)âŠ¸/) (OnGridÂ¨âŠ¸/) dirs + <coord
    visited {gridâ€¿type Search ğ•©â€¿ğ•¨}ËœÂ´ neighbors
}
Search_helper â† {gridğ•Šcoord: gridâ€¿(coordâŠ‘grid) Search coordâ€¿âŸ¨âŸ©}

#â€¢Show â‰  (in)â€¿'R' Search (0â€¿0)â€¿âŸ¨âŸ©

Perimiter â† {gridâ€¿type ğ•Š coords:
    all â† â¥Š>{dirs + <ğ•©}Â¨ coords
    #â€¢Show all
    us â† ((type=âŠ‘âŸœgrid)âŠ¸/) (OnGridÂ¨âŠ¸/) all
    (â‰ all) - â‰ us
}

Price â† {grid ğ•Š coord:
    type â† coordâŠ‘grid
    coords â† gridâ€¿type Search coordâ€¿âŸ¨âŸ©
    perim â† gridâ€¿type Perimiter coords
    (â‰ coords)Ã—perim
}

Part1 â† {ğ•Š grid:
    regions â† â·>{âŠ âˆ§grid Search_helper ğ•©}Â¨ GetIndices grid=grid
    +Â´ (<grid) PriceÂ¨ regions
}