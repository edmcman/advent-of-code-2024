in â† >â€¢file.Lines "input.txt"

FindStartIndex â† âŠ‘âˆ˜/â—‹â¥ŠâŸœ(â†•â‰¢)â‰¡Â¨âŸœ'^'

dirs â† 'U'â€¿'R'â€¿'D'â€¿'L'
deltas â† (Â¯1â€¿0)â€¿(0â€¿1)â€¿(1â€¿0)â€¿(0â€¿Â¯1)
MkState â† {
    dirâ‡0
    
    gridâ‡ğ•©
    coordâ‡FindStartIndex ğ•©
    GetDirDelta â‡ {ğ•¤
        dir âŠ‘ deltas
    }
    #HasObstacle â‡ { '#'=ğ•©âŠ‘grid }
    OnGrid â‡ âˆ§Â´(â‰¥âŸœ0)âˆ¾<âŸœ(â‰¢grid)
    HasObstacle â‡ '#'=âŠ‘âŸœgrid
    Turn â‡ {ğ•¤
        dir â†© 4|dir+1
    }

    Step â‡ {ğ•¤
        grid â†© 'X'âŒ¾(coordâŠ¸ âŠ‘) grid
        newcoord â† coord + GetDirDelta dir
        {OnGrid newcoord ?
        {
            HasObstacle newcoord ?
            # Can't move in current direction, try turning.
            Turn @;
            # Otherwise move
            coord â†© newcoord
        };
        # Move off the grid.
        coord â†© newcoord}
    }
}

While â† {ğ•©â€¢_while_ğ•¨@}Â´

Part1 â† {ğ•¤
    state â† MkState ğ•©

    While {ğ•¤â‹„state.OnGrid state.coord}â€¿{ğ•¤
        state.Step @
        #â€¢Show state.coord
    }

    â€¢Show count â† +Â´â¥Š'X'=state.grid
}

Part1 in